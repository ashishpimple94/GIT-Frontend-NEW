{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import api from'../config/axios';import'./ViewGrievance.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ViewGrievance=()=>{const{id}=useParams();const navigate=useNavigate();const[grievance,setGrievance]=useState(null);const[comments,setComments]=useState([]);const[newComment,setNewComment]=useState('');const[loading,setLoading]=useState(true);const[submitting,setSubmitting]=useState(false);useEffect(()=>{fetchGrievance();},[id]);const fetchGrievance=async()=>{try{const res=await api.get(\"/api/grievances/\".concat(id));setGrievance(res.data.grievance);setComments(res.data.comments||[]);}catch(error){console.error('Error fetching grievance:',error);}finally{setLoading(false);}};const handleSubmitComment=async e=>{e.preventDefault();if(!newComment.trim())return;setSubmitting(true);try{const res=await api.post(\"/api/grievances/\".concat(id,\"/comments\"),{comment:newComment});setComments([...comments,res.data]);setNewComment('');}catch(error){console.error('Error submitting comment:',error);}finally{setSubmitting(false);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"})})});}if(!grievance){return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Grievance not found\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/my-grievances'),className:\"btn btn-primary\",children:\"Back to Grievances\"})]})});}return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"view-grievance\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>navigate('/my-grievances'),className:\"btn btn-secondary\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-arrow-left\"}),\" Back\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card grievance-detail\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grievance-detail-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:grievance.subject}),/*#__PURE__*/_jsx(\"span\",{className:\"status-badge status-\".concat(grievance.status),children:grievance.status.replace('_',' ').toUpperCase()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grievance-detail-meta\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"meta-item\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Category:\"}),\" \",grievance.category]}),/*#__PURE__*/_jsxs(\"div\",{className:\"meta-item\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Priority:\"}),\" \",grievance.priority]}),/*#__PURE__*/_jsxs(\"div\",{className:\"meta-item\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Submitted:\"}),\" \",new Date(grievance.createdAt).toLocaleString()]}),grievance.assignedTo&&/*#__PURE__*/_jsxs(\"div\",{className:\"meta-item\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Assigned To:\"}),\" \",grievance.assignedTo.fullName||grievance.assignedTo.username]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grievance-description\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"p\",{children:grievance.description})]}),grievance.resolution&&/*#__PURE__*/_jsxs(\"div\",{className:\"grievance-resolution\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Resolution\"}),/*#__PURE__*/_jsx(\"p\",{children:grievance.resolution})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card comments-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Comments\"}),/*#__PURE__*/_jsx(\"div\",{className:\"comments-list\",children:comments.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-comments\",children:\"No comments yet\"}):comments.map(comment=>/*#__PURE__*/_jsxs(\"div\",{className:\"comment-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comment-header\",children:[/*#__PURE__*/_jsx(\"strong\",{children:comment.userId.fullName||comment.userId.username}),/*#__PURE__*/_jsx(\"span\",{className:\"comment-date\",children:new Date(comment.createdAt).toLocaleString()})]}),/*#__PURE__*/_jsx(\"p\",{className:\"comment-text\",children:comment.comment})]},comment._id))}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitComment,className:\"comment-form\",children:[/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control\",value:newComment,onChange:e=>setNewComment(e.target.value),placeholder:\"Add a comment...\",rows:\"3\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",disabled:submitting,children:submitting?'Posting...':'Post Comment'})]})]})]})});};export default ViewGrievance;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","api","jsx","_jsx","jsxs","_jsxs","ViewGrievance","id","navigate","grievance","setGrievance","comments","setComments","newComment","setNewComment","loading","setLoading","submitting","setSubmitting","fetchGrievance","res","get","concat","data","error","console","handleSubmitComment","e","preventDefault","trim","post","comment","className","children","onClick","subject","status","replace","toUpperCase","category","priority","Date","createdAt","toLocaleString","assignedTo","fullName","username","description","resolution","length","map","userId","_id","onSubmit","value","onChange","target","placeholder","rows","required","type","disabled"],"sources":["/Users/ashishpimple/Desktop/GIT/client/src/pages/ViewGrievance.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport api from '../config/axios';\nimport './ViewGrievance.css';\n\nconst ViewGrievance = () => {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [grievance, setGrievance] = useState(null);\n  const [comments, setComments] = useState([]);\n  const [newComment, setNewComment] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n\n  useEffect(() => {\n    fetchGrievance();\n  }, [id]);\n\n  const fetchGrievance = async () => {\n    try {\n      const res = await api.get(`/api/grievances/${id}`);\n      setGrievance(res.data.grievance);\n      setComments(res.data.comments || []);\n    } catch (error) {\n      console.error('Error fetching grievance:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSubmitComment = async (e) => {\n    e.preventDefault();\n    if (!newComment.trim()) return;\n\n    setSubmitting(true);\n    try {\n      const res = await api.post(`/api/grievances/${id}/comments`, {\n        comment: newComment\n      });\n      setComments([...comments, res.data]);\n      setNewComment('');\n    } catch (error) {\n      console.error('Error submitting comment:', error);\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"container\">\n        <div className=\"loading\">\n          <div className=\"spinner\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!grievance) {\n    return (\n      <div className=\"container\">\n        <div className=\"empty-state\">\n          <p>Grievance not found</p>\n          <button onClick={() => navigate('/my-grievances')} className=\"btn btn-primary\">\n            Back to Grievances\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container\">\n      <div className=\"view-grievance\">\n        <button onClick={() => navigate('/my-grievances')} className=\"btn btn-secondary\">\n          <i className=\"fas fa-arrow-left\"></i> Back\n        </button>\n\n        <div className=\"card grievance-detail\">\n          <div className=\"grievance-detail-header\">\n            <h1>{grievance.subject}</h1>\n            <span className={`status-badge status-${grievance.status}`}>\n              {grievance.status.replace('_', ' ').toUpperCase()}\n            </span>\n          </div>\n\n          <div className=\"grievance-detail-meta\">\n            <div className=\"meta-item\">\n              <strong>Category:</strong> {grievance.category}\n            </div>\n            <div className=\"meta-item\">\n              <strong>Priority:</strong> {grievance.priority}\n            </div>\n            <div className=\"meta-item\">\n              <strong>Submitted:</strong> {new Date(grievance.createdAt).toLocaleString()}\n            </div>\n            {grievance.assignedTo && (\n              <div className=\"meta-item\">\n                <strong>Assigned To:</strong> {grievance.assignedTo.fullName || grievance.assignedTo.username}\n              </div>\n            )}\n          </div>\n\n          <div className=\"grievance-description\">\n            <h3>Description</h3>\n            <p>{grievance.description}</p>\n          </div>\n\n          {grievance.resolution && (\n            <div className=\"grievance-resolution\">\n              <h3>Resolution</h3>\n              <p>{grievance.resolution}</p>\n            </div>\n          )}\n        </div>\n\n        <div className=\"card comments-section\">\n          <h2>Comments</h2>\n          <div className=\"comments-list\">\n            {comments.length === 0 ? (\n              <p className=\"no-comments\">No comments yet</p>\n            ) : (\n              comments.map(comment => (\n                <div key={comment._id} className=\"comment-item\">\n                  <div className=\"comment-header\">\n                    <strong>{comment.userId.fullName || comment.userId.username}</strong>\n                    <span className=\"comment-date\">\n                      {new Date(comment.createdAt).toLocaleString()}\n                    </span>\n                  </div>\n                  <p className=\"comment-text\">{comment.comment}</p>\n                </div>\n              ))\n            )}\n          </div>\n\n          <form onSubmit={handleSubmitComment} className=\"comment-form\">\n            <textarea\n              className=\"form-control\"\n              value={newComment}\n              onChange={(e) => setNewComment(e.target.value)}\n              placeholder=\"Add a comment...\"\n              rows=\"3\"\n              required\n            ></textarea>\n            <button type=\"submit\" className=\"btn btn-primary\" disabled={submitting}>\n              {submitting ? 'Posting...' : 'Post Comment'}\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ViewGrievance;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}